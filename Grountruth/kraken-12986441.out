Collecting albumentations
  Downloading albumentations-1.2.1-py3-none-any.whl (116 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 116.7/116.7 kB 3.3 MB/s eta 0:00:00
Requirement already satisfied: numpy>=1.11.1 in /home/users/j/jacsont/Kraken-env/lib/python3.8/site-packages (from albumentations) (1.22.4)
Requirement already satisfied: scikit-image>=0.16.1 in /home/users/j/jacsont/Kraken-env/lib/python3.8/site-packages (from albumentations) (0.19.2)
Collecting qudida>=0.0.4
  Using cached qudida-0.0.4-py3-none-any.whl (3.5 kB)
Collecting opencv-python-headless>=4.1.1
  Using cached opencv_python_headless-4.6.0.66-cp36-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (48.3 MB)
Requirement already satisfied: PyYAML in /home/users/j/jacsont/Kraken-env/lib/python3.8/site-packages (from albumentations) (6.0)
Requirement already satisfied: scipy in /home/users/j/jacsont/Kraken-env/lib/python3.8/site-packages (from albumentations) (1.8.1)
Collecting scikit-learn>=0.19.1
  Downloading scikit_learn-1.1.2-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (31.2 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 31.2/31.2 MB 58.7 MB/s eta 0:00:00
Requirement already satisfied: typing-extensions in /home/users/j/jacsont/Kraken-env/lib/python3.8/site-packages (from qudida>=0.0.4->albumentations) (4.2.0)
Requirement already satisfied: imageio>=2.4.1 in /home/users/j/jacsont/Kraken-env/lib/python3.8/site-packages (from scikit-image>=0.16.1->albumentations) (2.19.3)
Requirement already satisfied: networkx>=2.2 in /home/users/j/jacsont/Kraken-env/lib/python3.8/site-packages (from scikit-image>=0.16.1->albumentations) (2.8.4)
Requirement already satisfied: packaging>=20.0 in /home/users/j/jacsont/Kraken-env/lib/python3.8/site-packages (from scikit-image>=0.16.1->albumentations) (21.3)
Requirement already satisfied: pillow!=7.1.0,!=7.1.1,!=8.3.0,>=6.1.0 in /home/users/j/jacsont/Kraken-env/lib/python3.8/site-packages (from scikit-image>=0.16.1->albumentations) (9.1.1)
Requirement already satisfied: tifffile>=2019.7.26 in /home/users/j/jacsont/Kraken-env/lib/python3.8/site-packages (from scikit-image>=0.16.1->albumentations) (2022.5.4)
Requirement already satisfied: PyWavelets>=1.1.1 in /home/users/j/jacsont/Kraken-env/lib/python3.8/site-packages (from scikit-image>=0.16.1->albumentations) (1.3.0)
Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /home/users/j/jacsont/Kraken-env/lib/python3.8/site-packages (from packaging>=20.0->scikit-image>=0.16.1->albumentations) (3.0.9)
Collecting threadpoolctl>=2.0.0
  Using cached threadpoolctl-3.1.0-py3-none-any.whl (14 kB)
Collecting joblib>=1.0.0
  Downloading joblib-1.2.0-py3-none-any.whl (297 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 298.0/298.0 kB 6.9 MB/s eta 0:00:00
Installing collected packages: threadpoolctl, opencv-python-headless, joblib, scikit-learn, qudida, albumentations
Successfully installed albumentations-1.2.1 joblib-1.2.0 opencv-python-headless-4.6.0.66 qudida-0.0.4 scikit-learn-1.1.2 threadpoolctl-3.1.0

[notice] A new release of pip available: 22.1.2 -> 22.2.2
[notice] To update, run: pip install --upgrade pip
KETOS training
WARNING:root:scikit-learn version 1.1.2 is not supported. Minimum required version: 0.17. Maximum required version: 0.19.2. Disabling scikit-learn conversion API.
WARNING:root:Torch version 1.11.0+cu102 has not been tested with coremltools. You may run into unexpected errors. Torch 1.10.2 is the most recent version that has been tested.
╭───────────────────── Traceback (most recent call last) ──────────────────────╮
│ /home/users/j/jacsont/Kraken-env/bin/ketos:8 in <module>                     │
│                                                                              │
│   5 from kraken.ketos import cli                                             │
│   6 if __name__ == '__main__':                                               │
│   7 │   sys.argv[0] = re.sub(r'(-script\.pyw|\.exe)?$', '', sys.argv[0])     │
│ ❱ 8 │   sys.exit(cli())                                                      │
│   9                                                                          │
│                                                                              │
│ /home/users/j/jacsont/Kraken-env/lib/python3.8/site-packages/click/core.py:1 │
│ 130 in __call__                                                              │
│                                                                              │
│ /home/users/j/jacsont/Kraken-env/lib/python3.8/site-packages/click/core.py:1 │
│ 055 in main                                                                  │
│                                                                              │
│ /home/users/j/jacsont/Kraken-env/lib/python3.8/site-packages/click/core.py:1 │
│ 657 in invoke                                                                │
│                                                                              │
│ /home/users/j/jacsont/Kraken-env/lib/python3.8/site-packages/click/core.py:1 │
│ 404 in invoke                                                                │
│                                                                              │
│ /home/users/j/jacsont/Kraken-env/lib/python3.8/site-packages/click/core.py:7 │
│ 60 in invoke                                                                 │
│                                                                              │
│ /home/users/j/jacsont/Kraken-env/lib/python3.8/site-packages/click/decorator │
│ s.py:26 in new_func                                                          │
│                                                                              │
│ /home/users/j/jacsont/Kraken-env/lib/python3.8/site-packages/kraken/ketos.py │
│ :320 in segtrain                                                             │
│                                                                              │
│    317 │   if device == 'cpu':                                               │
│    318 │   │   device = None                                                 │
│    319 │   elif device.startswith('cuda'):                                   │
│ ❱  320 │   │   device = [int(device.split(':')[-1])]                         │
│    321 │                                                                     │
│    322 │   if hyper_params['freq'] > 1:                                      │
│    323 │   │   val_check_interval = {'check_val_every_n_epoch': int(hyper_pa │
╰──────────────────────────────────────────────────────────────────────────────╯
ValueError: invalid literal for int() with base 10: 'cuda'
srun: error: gpu005: task 0: Exited with exit code 1
